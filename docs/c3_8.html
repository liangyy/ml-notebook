<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Chapter 3: 3.8 - 3.9</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Machine Learning Notebook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="esl.html">ESL reading</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/liangyy/ml-notebook">
    <span class="fas fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Chapter 3: 3.8 - 3.9</h1>
<h4 class="date">28 December, 2020</h4>

</div>


<p><span class="math display">\[
\newcommand{\epe}{\text{EPE}}
\newcommand{\E}{\text{E}}
\newcommand{\mse}{\text{MSE}}
\newcommand{\tdata}{\mathcal{T}}
\newcommand{\bias}{\text{Bias}}
\newcommand{\var}{\text{Var}}
\newcommand{\cov}{\text{Cov}}
\newcommand{\corr}{\text{Corr}}
\newcommand{\rss}{\text{RSS}}
\newcommand{\tr}{\text{tr}}
\newcommand{\ridge}{\text{ridge}}
\newcommand{\pcr}{\text{pcr}}
\newcommand{\ls}{\text{ls}}
\newcommand{\tr}{\text{tr}}
\newcommand{\df}{\text{df}}
\newcommand{\FS}{\text{FS}}
\]</span></p>
<div id="incremental-forward-stagewise-regression" class="section level1">
<h1><span class="header-section-number">1</span> Incremental Forward Stagewise Regression</h1>
<p>This is similar to LAR but they are not the same. The algorithm is as follow (start with standardized features).</p>
<ol style="list-style-type: decimal">
<li>Start with <span class="math inline">\(\beta_k = 0\)</span> for all <span class="math inline">\(k\)</span> and residual <span class="math inline">\(r = y\)</span>.</li>
<li>Find <span class="math inline">\(j\)</span>th feature that correlates most to <span class="math inline">\(r\)</span>.</li>
<li>Update <span class="math inline">\(\beta_j = \beta_j + \delta_j\)</span> where <span class="math inline">\(\delta_j = \epsilon \cdot \text{sign}(\langle x_j, r \rangle)\)</span>.</li>
<li>Update <span class="math inline">\(r = r - \delta_j \cdot x_j\)</span>.</li>
<li>Repeat 2-4 steps until convergence (r is uncorrelated with any <span class="math inline">\(x\)</span>).</li>
</ol>
<p>It is a generalized version of forward stagewise regression (<span class="math inline">\(\FS_1\)</span>). We call it <span class="math inline">\(\FS_\epsilon\)</span>.</p>
<p><img src="../figures/c38_1.png" /></p>
<p>And <span class="math inline">\(\FS_0\)</span> is the case when <span class="math inline">\(\epsilon \rightarrow 0\)</span> (<strong>infinitesimal forward stagewise regression</strong>).</p>
<p>LAR algorithm with <span class="math inline">\(\FS_0\)</span> modification can solve <span class="math inline">\(\FS_0\)</span> problem.</p>
<p><img src="../figures/c38_2.png" /></p>
<p><span class="math inline">\(\FS_0\)</span> optimizes a complex problem evolving differential. In simple word, <span class="math inline">\(\FS_0\)</span> is more constrained that the lasso so it has less variance than the lasso especially when <span class="math inline">\(p &gt;&gt; N\)</span>.</p>
</div>
<div id="piecewise-linear-path-algorithms" class="section level1">
<h1><span class="header-section-number">2</span> Piecewise-Linear Path Algorithms</h1>
<p>LAR uses the piecewise-linear nature of lasso solution path. Similarly, path-based algorithms can be used for other problems with piecewise-linear solution path.</p>
<p>Suppose we want to solve <span class="math display">\[\begin{aligned}
  \beta &amp;= \arg\min_\beta [R(\beta) + \lambda J(\beta)] \\
  R(\beta) &amp;= sum_{i = 1}^N L(y_i, \sum_j x_{ij} \beta_j)
\end{aligned}\]</span> , where <span class="math inline">\(R\)</span> and <span class="math inline">\(J\)</span> should be convex. The followings are sufficient conditions to ensure that the solution path is piecewise-linear.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(R\)</span> is quadratic or piecewise-quadratic as a function of <span class="math inline">\(\beta\)</span>.</li>
<li><span class="math inline">\(J\)</span> is piecewise linear in <span class="math inline">\(\beta\)</span>.</li>
</ol>
<p>In this case, the solution can be efficiently computed. Examples are:</p>
<ul>
<li>Squared, absolute value losses</li>
<li>Huberized losses</li>
<li><span class="math inline">\(L_1\)</span> and <span class="math inline">\(L_\infty\)</span> penalties on <span class="math inline">\(\beta\)</span></li>
<li>Hinge loss in SVM (the solution pass of the dual problem is piecewise linear)</li>
</ul>
</div>
<div id="the-dantzig-selector" class="section level1">
<h1><span class="header-section-number">3</span> The Dantzig Selector</h1>
<p>I paste the problem here without going into more details. The problem is similar to lasso but it is much less popular.</p>
<p><img src="../figures/c38_3.png" /></p>
</div>
<div id="the-grouped-lasso" class="section level1">
<h1><span class="header-section-number">4</span> The Grouped Lasso</h1>
<p>The penalty term is</p>
<p><span class="math display">\[\begin{aligned}
  \lambda \sum_l \sqrt{p_l} \|\beta_l\|_2
\end{aligned}\]</span> with <span class="math inline">\(l\)</span> indexes group and <span class="math inline">\(p_l\)</span> indicates the size of the group. This criteria encourages all coefficients belonging to a group <span class="math inline">\(l\)</span> to be zero. A generalized version is <span class="math inline">\(\|\eta\|_K = (\eta&#39; K \eta)^{\frac{1}{2}}\)</span>. Furthermore, allowing overlapping groups.</p>
</div>
<div id="further-propertise-of-the-lasso" class="section level1">
<h1><span class="header-section-number">5</span> Further propertise of the lasso</h1>
<p>Many studies have focused on the performance of the lasso with <span class="math inline">\(N\)</span> and <span class="math inline">\(p\)</span> get large. One of the assumptions are about the correlation between <span class="math inline">\(X_S\)</span> and <span class="math inline">\(X_S^c\)</span> where <span class="math inline">\(S\)</span> is the set of features with non-zero coefficients in the true model. For instance, the condition could be <span class="math display">\[
\max_{j \in S^c} \| x_j&#39; X_S (X_S&#39; X_S)^{-1} \|_1 \le 1 - \epsilon, ~\epsilon \in (0, 1] 
\]</span> In short, in order for the lasso to have good performance, the non-true features should not be too correlated with the true features.</p>
<p>One of the downside of the lasso is that it shrinks the non-zero coefficient to zero which makes it inconsistent (as sample size approaches infinity, it does not converge to the true value). To solve this problem, one could use the lasso as a way of feature selection and re-fit the model using non-zeros only. In practice, this approach may be computationally demanding (to fit a large number of features simultaneously is not easy). In this case, one could use two round of CVs. In the first round CV, we do feature selection to select the related features. In the second round of CV, we use the selected features only and re-fit the hyper-parameter. The intuition is that with a small feature set to begin with, we could use a smaller penalty term which gives less severe shrinkage. (<strong>Note</strong>: The large penalty is to balance the number of features and the number of samples along with the amont of error)</p>
<p>Furthermore, The <em>smoothly clipped absolute deviation</em> (SCAD) is proposed in place of the lasso. It shrinks less on large coefficients (see figure below).</p>
<p><img src="../figures/c38_4.png" /> But the cost is that the penalty is not convex anymore which makes it hard to fit. Along this line, the <em>adaptive lasso</em> is proposed which is a weighted version of the lasso, <span class="math inline">\(\sum_k w_i |\beta_k|\)</span> with <span class="math inline">\(w_k = 1 / |\hat\beta_k|^{\nu}\)</span> where <span class="math inline">\(\hat\beta\)</span> is from OLS. This is an approximation of <span class="math inline">\(\|\beta\|^{1 - \nu}\)</span> penalty.</p>
</div>
<div id="pathwise-coordinate-optimization" class="section level1">
<h1><span class="header-section-number">6</span> Pathwise Coordinate Optimization</h1>
<p>This is an alternative algorithm to solve the lasso (other than the LARS) and this approach is based on simple coordinate descent. Fixing <span class="math inline">\(\lambda\)</span>, we loop over <span class="math inline">\(\beta_k\)</span> and update them one at a time. The objective at each iteration is <span class="math display">\[\sum_{i = 1}^N (y_i - \sum_{j \ne k} x_{ij} \tilde\beta_j - x_{ik} \beta_k)^2 + \lambda \sum_{j \ne k} |\beta_j| + \lambda |\beta_k|\]</span> The update rule for this objective is analytical, simply by soft-thresholding: <span class="math display">\[\tilde\beta_k \leftarrow S(y_i - \sum_{j \ne k} x_{ij} \tilde\beta_j, \lambda)\]</span> where <span class="math inline">\(S(t, \lambda) = \text{sign}(t)(|t| - \lambda)_+\)</span>.</p>
<p>In practice, we could start with <span class="math inline">\(\lambda_\max\)</span> such that <span class="math inline">\(\tilde\beta_j = 0, ~\forall j\)</span> and we gradually decreases <span class="math inline">\(\lambda\)</span> with the previous solution as warm-start. This algorithm is faster than LARS when the problem is large. We don’t get the whole solution path but the solution on a grid of <span class="math inline">\(\lambda\)</span>’s. This algorithm can also be applied to the elastic net and the grouped lasso (in case where the penalty is the sum of functions of the individual parameters). It can also be applied to the fused lasso with substantial modification.</p>
</div>
<div id="computational-considerations" class="section level1">
<h1><span class="header-section-number">7</span> Computational Considerations</h1>
<p>The least squares is done by Cholesky decomposition of <span class="math inline">\(X&#39;X\)</span> or QR decomposition of <span class="math inline">\(X\)</span>. For <span class="math inline">\(X \in \mathbb{R}^{N \times p}\)</span>, Cholesky decomp. needs <span class="math inline">\(p^3 + Np^2 / 2\)</span> operations and QR decomp. needs <span class="math inline">\(Np^2\)</span> operations.</p>
<p>Sometimes, Cholesky decomp. is faster but it could be less numerically stable. The lasso via LAR algorithm has the same complexity as least squares fits.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
